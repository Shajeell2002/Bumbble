<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test Friends</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; }
.user-card { padding: 10px; border: 1px solid #ccc; margin-bottom: 10px; border-radius: 5px; display: flex; align-items: center; }
.user-card img { width: 50px; height: 50px; border-radius: 50%; margin-right: 10px; object-fit: cover; }
.status-dot { width: 12px; height: 12px; border-radius: 50%; margin-left: auto; border: 1px solid #fff; }
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBkDyP8KPuQc_knXLH9lhtQWDLb59xRJWs",
  authDomain: "bumbble-c061f.firebaseapp.com",
  databaseURL: "https://bumbble-c061f-default-rtdb.firebaseio.com",
  projectId: "bumbble-c061f",
  storageBucket: "bumbble-c061f.appspot.com",
  messagingSenderId: "213165886981",
  appId: "1:213165886981:web:c18652003444869b1bd66c"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();
</script>
</head>
<body>

<h2>All Registered Users</h2>
<div id="usersContainer">Loading users...</div>

<script>
auth.onAuthStateChanged(user => {
  if(user){
    const usersContainer = document.getElementById("usersContainer");
    const usersRef = db.ref("users");

    usersRef.once("value").then(snapshot => {
      const users = snapshot.val() || {};
      usersContainer.innerHTML = "";

      if(Object.keys(users).length === 0){
        usersContainer.innerHTML = "<p>No users found.</p>";
      }

      for(let key in users){
        if(key === user.uid) continue; // skip self
        const u = users[key];
        const div = document.createElement("div");
        div.className = "user-card";

        const img = document.createElement("img");
        img.src = u.pic || "images/profile1.png";

        const name = document.createElement("span");
        name.textContent = u.name || "No Name";

        const status = document.createElement("span");
        status.className = "status-dot";
        status.style.backgroundColor = u.online ? "green" : "red";

        div.appendChild(img);
        div.appendChild(name);
        div.appendChild(status);
        usersContainer.appendChild(div);
      }
    }).catch(err => {
      usersContainer.innerHTML = "<p>Error loading users.</p>";
      console.error("Firebase read error:", err);
    });

  } else {
    document.getElementById("usersContainer").innerHTML = "<p>Please login to see users.</p>";
  }
});
</script>

</body>
</html>
