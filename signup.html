<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bumbble - Sign Up</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial, sans-serif;}

body{
  background:#b39ddb;
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

/* Header (same as stories.html) */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#b39ddb;
  padding:18px 22px;
  position:fixed;
  top:0;left:0;right:0;
  z-index:10;
  box-shadow:0 2px 6px rgba(0,0,0,0.12);
}
header h1{
  font-size:22px;
  font-weight:700;
  color:#fff;
}
nav a{
  margin-left:12px;
  font-size:15px;
  font-weight:600;
  text-decoration:none;
  color:white;
}
nav a:hover{text-decoration:underline;}

/* Signup box section */
main{
  flex:1;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:120px 20px 40px;
}

.signup-container{
  width:100%;
  max-width:420px;
  background:#fff;
  padding:32px;
  border-radius:14px;
  box-shadow:0 8px 22px rgba(0,0,0,.18);
}

.signup-container h2{
  text-align:center;
  margin-bottom:18px;
  font-size:22px;
  color:#4a2e8e;
}

.form-row{margin-bottom:12px;}

input, select{
  width:100%;
  padding:11px;
  border-radius:8px;
  border:1px solid #cfcfcf;
  font-size:15px;
}
input:focus, select:focus{
  border-color:#b39ddb;
  box-shadow:0 0 0 3px rgba(179,157,219,.24);
}

.btn{
  width:100%;padding:12px;border:none;
  background:#b39ddb;
  color:white;
  border-radius:8px;
  font-weight:700;font-size:16px;
  cursor:pointer;
}
.btn:hover{background:#9e85d2;}
.btn:disabled{background:#ccb9f6;cursor:not-allowed;}

.msg{text-align:center;margin-top:8px;font-size:14px;}
.error{color:#c62828;}
.success{color:#2e7d32;}

.small{text-align:center;margin-top:10px;font-size:13px;}
.small a{color:#4a2e8e;text-decoration:none;}
.small a:hover{text-decoration:underline;}

footer{
  text-align:center;
  padding:18px;
  background:#b39ddb;
  color:white;
  font-size:13px;
}
@media(max-width:480px){
  main{padding:140px 12px 40px;}
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>

<body>
<header>
  <h1>Bumbble</h1>
  <nav id="navLinks">
    <a href="index.html">Home</a>
    <a href="friends.html">Friends</a>
    <a href="stories.html">Stories</a>
    <a href="safety.html">Safety</a>
    <a href="login.html">Login</a>
    <a href="signup.html">Sign Up</a>
  </nav>
</header>

<main>
  <div class="signup-container">
    <h2>Create Your Account</h2>

    <div class="form-row"><input id="name" type="text" placeholder="Full name" required></div>
    <div class="form-row"><input id="age" type="number" placeholder="Age" min="13"></div>
    <div class="form-row">
      <select id="gender">
        <option value="">Select gender</option>
        <option value="Female">Female</option>
        <option value="Male">Male</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="form-row"><input id="location" type="text" placeholder="City"></div>
    <div class="form-row"><input id="email" type="email" placeholder="Email" required></div>
    <div class="form-row"><input id="password" type="password" placeholder="Password (min 6 chars)" required></div>

    <button id="signupBtn" class="btn">Sign Up</button>

    <p id="errorMsg" class="msg error"></p>
    <p id="successMsg" class="msg success"></p>

    <p class="small">Already have an account? <a href="login.html">Login</a></p>
  </div>
</main>

<footer>© 2025 Bumbble. All rights reserved.</footer>

<script>
// Firebase config
const firebaseConfig={
  apiKey:"AIzaSyBkDyP8KPuQc_knXLH9lhtQWDLb59xRJWs",
  authDomain:"bumbble-c061f.firebaseapp.com",
  databaseURL:"https://bumbble-c061f-default-rtdb.firebaseio.com",
  projectId:"bumbble-c061f",
  storageBucket:"bumbble-c061f.appspot.com",
  messagingSenderId:"213165886981",
  appId:"1:213165886981:web:c18652003444869b1bd66c"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.database();

// nav update
const nav=document.getElementById("navLinks");
auth.onAuthStateChanged(user=>{
  if(user && user.emailVerified){
    nav.innerHTML=`
      <a href="index.html">Home</a>
      <a href="friends.html">Friends</a>
      <a href="stories.html">Stories</a>
      <a href="safety.html">Safety</a>
      <a href="profile.html">Profile</a>
      <a href="#" id="logoutBtn">Logout</a>`;
    document.getElementById("logoutBtn").onclick=()=>{auth.signOut(); localStorage.removeItem("current_user"); location.href="login.html";}
  }
});

// Signup logic
document.getElementById("signupBtn").onclick=async()=>{
  const name=name.value.trim(), age=age.value.trim(), gender=gender.value,
        location=location.value.trim(), email=email.value.trim(),
        password=password.value, btn=signupBtn;
  errorMsg.textContent=""; successMsg.textContent="";

  if(!name||!email||!password){errorMsg.textContent="Enter name, email & password";return;}
  if(password.length<6){errorMsg.textContent="Password must be 6+ chars";return;}

  btn.disabled=true; btn.textContent="Creating...";
  try{
    const cred=await auth.createUserWithEmailAndPassword(email,password);
    const uid=cred.user.uid;
    await cred.user.sendEmailVerification({url:"https://bumbble.in/login.html"});
    
    await db.ref(`users/${uid}/public`).set({
      name, age:age||"N/A", gender:gender||"", location:location||"",
      pic:"images/profile1.png", online:false, testAccount:false
    });
    await db.ref(`users/${uid}/private`).set({email, createdAt:Date.now()});

    successMsg.textContent="✅ Account created! Check email to verify.";
    btn.textContent="Done";
    setTimeout(()=>location.href="login.html",3000);
  }catch(e){errorMsg.textContent=e.message; btn.disabled=false; btn.textContent="Sign Up";}
};
</script>
</body>
</html>
