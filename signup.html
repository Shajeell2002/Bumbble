<script>
// Firebase references
const auth = firebase.auth();
const db = firebase.database();

document.addEventListener("DOMContentLoaded", function(){
    const form = document.getElementById("signupForm");

    form.addEventListener("submit", function(e){
        e.preventDefault();

        const name = document.getElementById("name").value.trim();
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();

        if(!name || !email || !password){
            alert("Please fill all fields.");
            return;
        }

        // Create Firebase user
        auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
            const user = userCredential.user;

            user.updateProfile({ displayName: name }).then(() => {

                // Save user in Realtime Database
                const userData = {
                    name: name,
                    email: email,
                    lastLogin: Date.now(),
                    online: true
                };
                db.ref("users/" + user.uid).set(userData);

                // Send Firebase email verification
                user.sendEmailVerification().then(() => {
                    alert("✅ Signup successful! Verification email sent. Please check your inbox.");
                    form.reset();
                });
            });
        })
        .catch((error) => {
            alert("❌ " + error.message);
        });
    });
});
</script>
