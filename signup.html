<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bumbble - Sign Up</title>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

/* Purple theme like stories & safety */
body {
  font-family: Arial, sans-serif;
  background: #b39ddb;
  color: #333;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Header */
header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px;
  background:#b39ddb;
  color:white;
  position:fixed;
  top:0; left:0; right:0;
  z-index:500;
  box-shadow:0 3px 6px rgba(0,0,0,0.15);
}
header h1 { font-size:24px; color:white; }
nav a { margin:0 10px; text-decoration:none; color:white; font-weight:bold; }
nav a:hover { text-decoration:underline; }

/* Page layout */
main {
  flex:1;
  display:flex;
  justify-content:center;
  padding:120px 20px 40px;
}

/* Signup card */
.signup-box {
  background:#fff;
  width:100%;
  max-width:440px;
  padding:30px;
  border-radius:15px;
  box-shadow:0 2px 8px rgba(0,0,0,0.12);
}

.signup-box h2 {
  text-align:center;
  font-size:26px;
  margin-bottom:18px;
  color:#4a2e8e;
}

.form-row { margin-bottom:12px; }

input, select {
  width:100%;
  padding:12px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:15px;
}

input:focus, select:focus {
  border-color:#b39ddb;
  box-shadow:0 0 0 3px rgba(179,157,219,0.3);
  outline:none;
}

/* Button */
.btn {
  width:100%;
  padding:13px;
  background:#4a2e8e;
  border:none;
  color:white;
  font-weight:700;
  font-size:16px;
  border-radius:10px;
  cursor:pointer;
}
.btn:disabled { opacity:.6; cursor:not-allowed; }
.btn:hover { opacity:.9; }

/* Messages */
.msg { text-align:center; font-size:14px; margin-top:5px; }
.error { color:#c62828; }
.success { color:#2e7d32; }

.small-text { text-align:center; font-size:14px; margin-top:14px; }
.small-text a { color:#4a2e8e; font-weight:bold; text-decoration:none; }
.small-text a:hover { text-decoration:underline; }

/* Footer */
footer {
  text-align:center;
  padding:20px;
  background:#b39ddb;
  color:white;
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>

<body>

<header>
  <h1>Bumbble</h1>
  <nav id="navLinks"></nav>
</header>

<main>
  <div class="signup-box" role="region" aria-label="Signup form">
    <h2>Create Your Account</h2>

    <div class="form-row"><input id="name" type="text" placeholder="Full name" /></div>
    <div class="form-row"><input id="age" type="number" min="13" placeholder="Age" /></div>

    <div class="form-row">
      <select id="gender">
        <option value="">Select gender</option>
        <option value="Female">Female</option>
        <option value="Male">Male</option>
        <option value="Other">Other</option>
      </select>
    </div>

    <div class="form-row"><input id="location" type="text" placeholder="City" /></div>
    <div class="form-row"><input id="email" type="email" placeholder="Email address" /></div>
    <div class="form-row"><input id="password" type="password" placeholder="Password (min 6 chars)" /></div>

    <button id="signupBtn" class="btn">Sign Up</button>

    <p id="errorMsg" class="msg error" aria-live="polite"></p>
    <p id="successMsg" class="msg success" aria-live="polite"></p>

    <p class="small-text">Already have an account? <a href="login.html">Login</a></p>
  </div>
</main>

<footer>&copy; 2025 Bumbble. All rights reserved.</footer>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBkDyP8KPuQc_knXLH9lhtQWDLb59xRJWs",
  authDomain: "bumbble-c061f.firebaseapp.com",
  databaseURL: "https://bumbble-c061f-default-rtdb.firebaseio.com",
  projectId: "bumbble-c061f",
  storageBucket: "bumbble-c061f.appspot.com",
  messagingSenderId: "213165886981",
  appId: "1:213165886981:web:c18652003444869b1bd66c"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

/* Nav Update (same logic as your working code) */
const nav = document.getElementById('navLinks');
auth.onAuthStateChanged(user => {
  if (user && user.emailVerified) {
    nav.innerHTML = `
      <a href="index.html">Home</a>
      <a href="friends.html">Friends</a>
      <a href="stories.html">Stories</a>
      <a href="events.html">Events</a>
      <a href="safety.html">Safety</a>
      <a href="profile.html">Profile</a>
      <a href="#" id="logoutBtn">Logout</a>
    `;
    document.getElementById('logoutBtn').addEventListener('click', () => {
      auth.signOut();
      localStorage.removeItem('current_user');
      window.location.href = 'login.html';
    });
  } else {
    nav.innerHTML = `
      <a href="index.html">Home</a>
      <a href="friends.html">Friends</a>
      <a href="stories.html">Stories</a>
      <a href="events.html">Events</a>
      <a href="safety.html">Safety</a>
      <a href="login.html">Login</a>
      <a href="signup.html">Sign Up</a>
    `;
  }
});

/* Signup handler (restored working logic) */
document.getElementById('signupBtn').addEventListener('click', async function () {
  const name = document.getElementById('name').value.trim();
  const age = document.getElementById('age').value.trim();
  const gender = document.getElementById('gender').value;
  const location = document.getElementById('location').value.trim();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;

  const errorMsg = document.getElementById('errorMsg');
  const successMsg = document.getElementById('successMsg');
  const btn = document.getElementById('signupBtn');

  errorMsg.textContent = '';
  successMsg.textContent = '';

  // Basic validation (same as your working code)
  if (!name || !email || !password) {
    errorMsg.textContent = 'Please fill in name, email and password.';
    return;
  }
  if (password.length < 6) {
    errorMsg.textContent = 'Password must be at least 6 characters.';
    return;
  }

  btn.disabled = true;
  btn.textContent = 'Creating account...';

  try {
    // create account
    const cred = await auth.createUserWithEmailAndPassword(email, password);
    const user = cred.user;
    const uid = user.uid;

    // send verification email (redirects to login on click)
    await user.sendEmailVerification({ url: 'https://bumbble.in/login.html' });

    // save public profile
    await db.ref(`users/${uid}/public`).set({
      name: name,
      age: age || 'N/A',
      gender: gender || '',
      location: location || '',
      pic: 'images/profile1.png',
      online: false,
      testAccount: false
    });

    // save private profile
    await db.ref(`users/${uid}/private`).set({
      email: email,
      createdAt: Date.now()
    });

    successMsg.textContent = 'Account created â€” verification email sent, Check your Inbox & Spam folder . Please verify before login.';
    btn.textContent = 'Done';
    // optional: redirect after short delay
    setTimeout(() => { window.location.href = 'login.html'; }, 3500);

  } catch (err) {
    console.error('Signup error:', err);
    errorMsg.textContent = err.message || 'Signup failed.';
    btn.disabled = false;
    btn.textContent = 'Sign Up';
  }
});
</script>
</body>
</html>

