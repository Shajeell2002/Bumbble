<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bumbble - Profile</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:Arial,sans-serif;background:#fff;color:#333;min-height:100vh;display:flex;flex-direction:column;}

  /* HEADER */
  header{display:flex;justify-content:space-between;align-items:center;padding:20px;background:#ffcb2b;}
  header h1{font-size:24px;}
  nav a{margin:0 10px;text-decoration:none;color:#333;font-weight:bold;}
  nav a:hover{text-decoration:underline;}

  /* PROFILE SECTION */
  .section{flex:1;padding:40px 20px;}
  .section h2{text-align:center;font-size:28px;margin-bottom:20px;}

  .profile-container{max-width:500px;margin:0 auto;display:flex;flex-direction:column;gap:20px;}
  .profile-card{background:#f9f9f9;border-radius:15px;padding:20px;box-shadow:0 2px 6px rgba(0,0,0,0.1);text-align:center;}
  .profile-card img{width:120px;border-radius:50%;margin-bottom:15px;}
  .profile-card h3{margin-bottom:8px;}
  .profile-card p{font-size:14px;margin-bottom:10px;}
  .profile-card button{background:#ffcb2b;border:none;padding:10px 20px;font-size:16px;font-weight:bold;cursor:pointer;border-radius:20px;}

  /* CHANGE PASSWORD */
  .change-password{background:#f9f9f9;padding:20px;border-radius:15px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
  .change-password input{width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc;}
  .change-password button{width:100%;padding:10px;background:#ffcb2b;border:none;font-weight:bold;font-size:16px;border-radius:8px;cursor:pointer;}

  /* FOOTER */
  footer{text-align:center;padding:20px;background:#f1f1f1;margin-top:auto;}
</style>
</head>
<body>

<header>
  <h1>Bumbble</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="date.html">Date</a>
    <a href="friends.html">Friends</a>
    <a href="stories.html">Stories</a>
    <a href="events.html">Events</a>
    <a href="safety.html">Safety</a>
    <a href="login.html">Login</a>
    <a href="signup.html">Sign Up</a>
    <a href="profile.html">Profile</a>
  </nav>
</header>

<section class="section">
  <h2>User Profile</h2>
  <div class="profile-container">
    <div class="profile-card">
      <img id="profilePic" src="images/profile1.png" alt="User profile picture">
      <h3 id="profileName">User Name</h3>
      <p id="profileEmail">Email: user@example.com</p>
      <p id="profileBio">Bio: Add your bio here.</p>
    </div>

    <div class="change-password">
      <h3>Change Password</h3>
      <input type="password" id="currentPassword" placeholder="Current Password" required>
      <input type="password" id="newPassword" placeholder="New Password" required>
      <input type="password" id="confirmPassword" placeholder="Confirm New Password" required>
      <button id="changePwdBtn">Update Password</button>
    </div>
  </div>
</section>

<footer>
  <p>&copy; 2025 Bumbble. All rights reserved.</p>
</footer>

<script>
  // Check if user is logged in
  const currentUserEmail = localStorage.getItem("current_user");
  if(!currentUserEmail){
    alert("No user logged in. Redirecting to login page.");
    window.location.href = "login.html";
  } else {
    const userData = JSON.parse(localStorage.getItem("user_" + currentUserEmail));
    if(userData){
      document.getElementById("profileName").innerText = userData.name;
      document.getElementById("profileEmail").innerText = "Email: " + userData.email;
      document.getElementById("profileBio").innerText = "Bio: " + (userData.bio || "Add your bio here.");
      if(userData.profilePic) document.getElementById("profilePic").src = userData.profilePic;
    }
  }

  // Change password logic
  document.getElementById("changePwdBtn").addEventListener("click", function(){
    const currentPwdInput = document.getElementById("currentPassword").value;
    const newPwdInput = document.getElementById("newPassword").value;
    const confirmPwdInput = document.getElementById("confirmPassword").value;

    if(!currentPwdInput || !newPwdInput || !confirmPwdInput){
      alert("Please fill all fields.");
      return;
    }

    const userData = JSON.parse(localStorage.getItem("user_" + currentUserEmail));

    if(userData.password !== currentPwdInput){
      alert("❌ Current password is incorrect.");
      return;
    }

    if(newPwdInput !== confirmPwdInput){
      alert("❌ New passwords do not match.");
      return;
    }

    // Update password and save
    userData.password = newPwdInput;
    localStorage.setItem("user_" + currentUserEmail, JSON.stringify(userData));

    alert("✅ Password updated successfully!");
    // Clear inputs
    document.getElementById("currentPassword").value = "";
    document.getElementById("newPassword").value = "";
    document.getElementById("confirmPassword").value = "";
  });
</script>

</body>
</html>
