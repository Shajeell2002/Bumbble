<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bumbble - Profile</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: Arial, sans-serif; background:#fff; color:#333; min-height:100vh; display:flex; flex-direction:column;}
header { display:flex; justify-content:space-between; align-items:center; padding:20px; background:#ffcb2b; }
header h1 { font-size:24px; }
nav a { margin:0 10px; text-decoration:none; color:#333; font-weight:bold; }
nav a:hover { text-decoration: underline; }

.section { flex:1; padding:40px 20px; }
.section h2 { font-size:28px; margin-bottom:20px; text-align:center; }

.profile-container { display:flex; flex-direction:column; align-items:center; gap:20px; }
.profile-card { background:#f9f9f9; border-radius:15px; padding:20px; width:300px; text-align:center; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
.profile-card img { width:100px; height:100px; border-radius:50%; object-fit:cover; margin-bottom:15px; cursor:pointer; }
.profile-card h3 { margin-bottom:8px; }
.profile-card p { font-size:14px; margin-bottom:10px; }
.profile-card button { background:#ffcb2b; border:none; padding:10px 20px; font-size:16px; font-weight:bold; cursor:pointer; border-radius:20px; margin:3px; }
.logout-btn { background:#ff5c5c; color:#fff; }

footer { text-align:center; padding:20px; background:#f1f1f1; margin-top:auto; }
@media(max-width:768px){.profile-card{width:90%;}}
</style>
</head>
<body>

<header>
  <h1>Bumbble</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="date.html">Date</a>
    <a href="friends.html">Friends</a>
    <a href="stories.html">Stories</a>
    <a href="events.html">Events</a>
    <a href="safety.html">Safety</a>
    <a href="login.html">Login</a>
    <a href="signup.html">Sign Up</a>
    <a href="profile.html">Profile</a>
  </nav>
</header>

<section class="section">
  <h2>User Profile</h2>
  <div class="profile-container" id="profileContainer"></div>
</section>

<footer>
  <p>&copy; 2025 Bumbble. All rights reserved.</p>
</footer>

<script>
// Get current logged-in user
const currentUserEmail = localStorage.getItem("current_user");
if (!currentUserEmail) {
    alert("❌ No user logged in. Redirecting to login page.");
    window.location.href = "login.html";
}

// Get user data from localStorage
let userData = JSON.parse(localStorage.getItem("user_" + currentUserEmail));

// Create profile card
const profileContainer = document.getElementById("profileContainer");

function renderProfile() {
    profileContainer.innerHTML = `
      <div class="profile-card">
        <img id="profilePic" src="${userData.pic || 'images/profile1.png'}" alt="Profile Picture">
        <h3 id="userName">${userData.name}</h3>
        <p><strong>Email:</strong> ${currentUserEmail}</p>
        <p><strong>Bio:</strong> <span id="userBio">${userData.bio || "Add your bio"}</span></p>
        <p><strong>Gender:</strong> <span id="userGender">${userData.gender || "Not specified"}</span></p>
        <p><strong>Location:</strong> <span id="userLocation">${userData.location || "Not specified"}</span></p>
        <button id="editProfile">Edit Profile</button>
        <button id="changePwd">Change Password</button>
        <button id="logout" class="logout-btn">Logout</button>
      </div>
    `;

    // Profile picture update
    document.getElementById("profilePic").addEventListener("click", () => {
        const newPic = prompt("Enter URL of new profile picture:", userData.pic || "");
        if (newPic) {
            userData.pic = newPic;
            saveUserData();
            renderProfile();
        }
    });

    // Edit Profile button
    document.getElementById("editProfile").addEventListener("click", () => {
        const newName = prompt("Enter new name:", userData.name);
        const newBio = prompt("Enter bio:", userData.bio || "");
        const newGender = prompt("Enter gender:", userData.gender || "");
        const newLocation = prompt("Enter location:", userData.location || "");
        if(newName) userData.name = newName;
        if(newBio) userData.bio = newBio;
        if(newGender) userData.gender = newGender;
        if(newLocation) userData.location = newLocation;
        saveUserData();
        renderProfile();
    });

    // Change Password button
    document.getElementById("changePwd").addEventListener("click", () => {
        const currentPwd = prompt("Enter current password:");
        if(currentPwd !== userData.password){
            alert("❌ Current password incorrect.");
            return;
        }
        const newPwd = prompt("Enter new password:");
        if(newPwd){
            userData.password = newPwd;
            saveUserData();
            alert("✅ Password updated successfully.");
        }
    });

    // Logout button
    document.getElementById("logout").addEventListener("click", () => {
        localStorage.removeItem("current_user");
        alert("✅ Logged out successfully.");
        window.location.href = "login.html";
    });
}

// Save user data back to localStorage
function saveUserData() {
    localStorage.setItem("user_" + currentUserEmail, JSON.stringify(userData));
}

// Initial render
renderProfile();
</script>

</body>
</html>
